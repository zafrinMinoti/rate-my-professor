{"paragraphs":[{"text":"%pyspark\ndf = spark.read.json(\"/home/zafrin/PycharmProjects/RateMyProfessor/data/raw/reviews_old_play.json\")","user":"anonymous","dateUpdated":"2018-07-28T22:52:53-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://zafrin-ThinkPad-X1-Carbon-4th:4040/jobs/job?id=38"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1532802449278_-881880593","id":"20180728-142729_2020133553","dateCreated":"2018-07-28T14:27:29-0400","dateStarted":"2018-07-28T22:52:53-0400","dateFinished":"2018-07-28T22:52:54-0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2307"},{"text":"%pyspark\ndf.printSchema()","user":"anonymous","dateUpdated":"2018-07-28T22:52:54-0400","config":{"colWidth":11,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":315.85,"optionOpen":false}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- _corrupt_record: string (nullable = true)\n |-- attendence: string (nullable = true)\n |-- class_names: string (nullable = true)\n |-- comments: string (nullable = true)\n |-- date: string (nullable = true)\n |-- for_credits: string (nullable = true)\n |-- grades_revieved: string (nullable = true)\n |-- level_of_difficulty: string (nullable = true)\n |-- overall_quality: string (nullable = true)\n |-- prof_id: long (nullable = true)\n |-- rating_type: string (nullable = true)\n |-- tags_by_user: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- textbook_used: string (nullable = true)\n |-- thumbs_down: string (nullable = true)\n |-- thumbs_up: string (nullable = true)\n |-- would_take_again: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1532802798925_-1863649204","id":"20180728-143318_1762323921","dateCreated":"2018-07-28T14:33:18-0400","dateStarted":"2018-07-28T22:52:54-0400","dateFinished":"2018-07-28T22:52:54-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2309"},{"text":"%pyspark\ndf.describe().show()","user":"anonymous","dateUpdated":"2018-07-28T22:52:54-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+--------------------+--------------+--------------------+--------------------+----------+-----------+---------------+-------------------+------------------+------------------+-----------+-------------+-------------------+------------------+----------------+\n|summary|     _corrupt_record|    attendence|         class_names|            comments|      date|for_credits|grades_revieved|level_of_difficulty|   overall_quality|           prof_id|rating_type|textbook_used|        thumbs_down|         thumbs_up|would_take_again|\n+-------+--------------------+--------------+--------------------+--------------------+----------+-----------+---------------+-------------------+------------------+------------------+-----------+-------------+-------------------+------------------+----------------+\n|  count|                   2|        183185|              183185|              183185|    183185|     183185|         183185|             183185|            183185|            183185|     183185|       183185|             183185|            183185|          183185|\n|   mean|                null|          null| 9.613437220924631E8|  142889.57142857142|      null|       null|           null| 2.9659415345142888|3.6128231023282473|105712.86881567814|       null|         null|0.17755274722275297|0.2545131970412425|            null|\n| stddev|                null|          null|1.811405202067163...|  377949.73607075366|      null|       null|           null| 1.3010736117535993|1.4467899827233413|  3153.62764119124|       null|         null|  2.127846848008638|1.5649755805247567|            null|\n|    min|[{\"prof_id\": 1000...|     Mandatory|                   0|                    |01/01/2003|        N/A|              A|                1.0|               1.0|            100001|    average|          N/A|                  0|                 0|             N/A|\n|    max|                   ]| Not Mandatory|          ZOOLOGY225|김교수님께서는 좋아요! 나는 한...|12/31/2017|       Yes |             WD|                5.0|               5.0|            110993|       poor|          Yes|                 95|                 9|             Yes|\n+-------+--------------------+--------------+--------------------+--------------------+----------+-----------+---------------+-------------------+------------------+------------------+-----------+-------------+-------------------+------------------+----------------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://zafrin-ThinkPad-X1-Carbon-4th:4040/jobs/job?id=39"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1532817601765_-362966896","id":"20180728-184001_894968235","dateCreated":"2018-07-28T18:40:01-0400","dateStarted":"2018-07-28T22:52:54-0400","dateFinished":"2018-07-28T22:52:58-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2310"},{"text":"%pyspark\nprof_review_count = df.groupby('prof_id').count()","user":"anonymous","dateUpdated":"2018-07-28T22:52:58-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1532817707474_532877372","id":"20180728-184147_1907230023","dateCreated":"2018-07-28T18:41:47-0400","dateStarted":"2018-07-28T22:52:58-0400","dateFinished":"2018-07-28T22:52:58-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2311"},{"text":"%pyspark\ntotal_reviews = prof_review_count.count()\nlessthan10 = review_count.filter(review_count['count'] < 10).count()\nprint('Professors with more than 10 reviews: {}\\t{}%'.format(total_reviews-lessthan10, \n                                                            (total_reviews-lessthan10)/total_reviews*100))","user":"anonymous","dateUpdated":"2018-07-28T22:52:58-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"Fail to execute line 2: lessthan10 = review_count.filter(review_count['count'] < 10).count()\nTraceback (most recent call last):\n  File \"/tmp/zeppelin_pyspark-8711905360501894737.py\", line 375, in <module>\n    exec(code, _zcUserQueryNameSpace)\n  File \"<stdin>\", line 2, in <module>\nNameError: name 'review_count' is not defined\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://zafrin-ThinkPad-X1-Carbon-4th:4040/jobs/job?id=40"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1532817854252_-1540030536","id":"20180728-184414_1226690251","dateCreated":"2018-07-28T18:44:14-0400","dateStarted":"2018-07-28T22:52:58-0400","dateFinished":"2018-07-28T22:52:59-0400","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:2312"},{"text":"%pyspark\ngrade_count = df.groupby('grades_revieved').count()\ngrade_count.show()","user":"anonymous","dateUpdated":"2018-07-28T22:43:58-0400","config":{"colWidth":11,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":428,"optionOpen":false}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------------+------+\n|grades_revieved| count|\n+---------------+------+\n|   Not sure yet|  1028|\n|            INC|   110|\n|             B-|   589|\n|           null|     2|\n|             WD|   373|\n|             C-|   207|\n|              C|   741|\n|             B+|  1962|\n|             D+|   101|\n|             D-|    44|\n|             A-|  1763|\n| Audit/No Grade|    22|\n|              B|  2153|\n|              A|  6398|\n|              F|   218|\n|            N/A|164295|\n|              D|   203|\n|             C+|   532|\n|              P|    74|\n|             A+|  2372|\n+---------------+------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://zafrin-ThinkPad-X1-Carbon-4th:4040/jobs/job?id=31","http://zafrin-ThinkPad-X1-Carbon-4th:4040/jobs/job?id=32","http://zafrin-ThinkPad-X1-Carbon-4th:4040/jobs/job?id=33","http://zafrin-ThinkPad-X1-Carbon-4th:4040/jobs/job?id=34","http://zafrin-ThinkPad-X1-Carbon-4th:4040/jobs/job?id=35"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1532818089762_487414440","id":"20180728-184809_506309312","dateCreated":"2018-07-28T18:48:09-0400","dateStarted":"2018-07-28T22:43:45-0400","dateFinished":"2018-07-28T22:43:46-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2314"},{"user":"anonymous","config":{"colWidth":12,"fontSize":10,"enabled":false,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","lineNumbers":false,"tableHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1532819765050_1794910426","id":"20180728-191605_1368311446","dateCreated":"2018-07-28T19:16:05-0400","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:2315","dateUpdated":"2018-07-28T21:06:33-0400","dateFinished":"2018-07-28T19:58:44-0400","dateStarted":"2018-07-28T19:58:44-0400","errorMessage":"","text":"Look at distribution of overall quality groupby grades recieved\n- compare to the distribution of overall quality\nLook at comment length vs grade recieved\nLook at comment length vs overall quality\nLook at comment length vs overall difficulity\nLook at comment overall quality vs level of dificulity\nAverage overall quality over time.\n- what characteristics are associated with professors whose overall quality increases, decreases over time or stays the same.\nMost associted keywords with thumbs up/down\nDistribution of overall quality for thumbs up/down\nDistribution of comment length for thumbs up/down"},{"text":"%pyspark\nfrom pyspark.sql.functions import *","user":"anonymous","dateUpdated":"2018-07-28T22:59:26-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1532819094477_-1303802247","id":"20180728-190454_1363546601","dateCreated":"2018-07-28T19:04:54-0400","dateStarted":"2018-07-28T22:59:26-0400","dateFinished":"2018-07-28T22:59:26-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2313","focus":true},{"text":"%pyspark\ndf2 = df.withColumn('grade', ltrim(df['grades_revieved']))","user":"anonymous","dateUpdated":"2018-07-28T22:47:45-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1532832281838_-2106246007","id":"20180728-224441_1985403609","dateCreated":"2018-07-28T22:44:41-0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3947","dateFinished":"2018-07-28T22:47:24-0400","dateStarted":"2018-07-28T22:47:24-0400","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"DataFrame[_corrupt_record: string, attendence: string, class_names: string, comments: string, date: string, for_credits: string, grades_revieved: string, level_of_difficulty: string, overall_quality: string, prof_id: bigint, rating_type: string, tags_by_user: array<string>, textbook_used: string, thumbs_down: string, thumbs_up: string, would_take_again: string, grade: string]\n"}]}},{"text":"%pyspark\ndf2.head(3)[0]","user":"anonymous","dateUpdated":"2018-07-28T22:45:25-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1532832296259_974067884","id":"20180728-224456_1949132521","dateCreated":"2018-07-28T22:44:56-0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4019","dateFinished":"2018-07-28T22:45:26-0400","dateStarted":"2018-07-28T22:45:25-0400","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Row(_corrupt_record='[{\"prof_id\": 100001, \"date\": \"12/14/2017\", \"rating_type\": \"good\", \"overall_quality\": \"4.0\", \"level_of_difficulty\": \"3.0\", \"class_names\": \"SOC106\", \"for_credits\": \" Yes\", \"attendence\": \" Mandatory\", \"textbook_used\": \" No\", \"would_take_again\": \" Yes\", \"grades_revieved\": \" N/A\", \"tags_by_user\": [\"CARING\", \"RESPECTED\", \"GET READY TO READ\"], \"comments\": \"Clawson is really caring and interested in his students so it\\'s an easy class to pass, although there is A LOT of reading which is important to quizzes (a pretty big part of your grade) and the final exam. There\\'s a big paper but its very doable and Dan is very easy to work with. Lectures get a bit tedious but can be though provoking\", \"thumbs_up\": \"0\", \"thumbs_down\": \"0\"},', attendence=None, class_names=None, comments=None, date=None, for_credits=None, grades_revieved=None, level_of_difficulty=None, overall_quality=None, prof_id=None, rating_type=None, tags_by_user=None, textbook_used=None, thumbs_down=None, thumbs_up=None, would_take_again=None, grade=None)\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://zafrin-ThinkPad-X1-Carbon-4th:4040/jobs/job?id=37"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\ndf2.printSchema()","user":"anonymous","dateUpdated":"2018-07-28T22:53:25-0400","config":{"colWidth":11,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":354,"optionOpen":false}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1532832356843_115883293","id":"20180728-224556_96947144","dateCreated":"2018-07-28T22:45:56-0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4170","dateFinished":"2018-07-28T22:46:41-0400","dateStarted":"2018-07-28T22:46:41-0400","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- _corrupt_record: string (nullable = true)\n |-- attendence: string (nullable = true)\n |-- class_names: string (nullable = true)\n |-- comments: string (nullable = true)\n |-- date: string (nullable = true)\n |-- for_credits: string (nullable = true)\n |-- grades_revieved: string (nullable = true)\n |-- level_of_difficulty: string (nullable = true)\n |-- overall_quality: string (nullable = true)\n |-- prof_id: long (nullable = true)\n |-- rating_type: string (nullable = true)\n |-- tags_by_user: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- textbook_used: string (nullable = true)\n |-- thumbs_down: string (nullable = true)\n |-- thumbs_up: string (nullable = true)\n |-- would_take_again: string (nullable = true)\n |-- grade: string (nullable = true)\n\n"}]}},{"text":"%pyspark\nfrom pyspark.sql.functions import col, size\n\ndf.where(size(col(\"tags_by_user\")) > 3).show()","user":"anonymous","dateUpdated":"2018-07-28T23:54:53-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1532836239842_-1334687281","id":"20180728-235039_541310353","dateCreated":"2018-07-28T23:50:39-0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:7112","dateFinished":"2018-07-28T23:54:54-0400","dateStarted":"2018-07-28T23:54:53-0400","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------------+----------+-----------+--------+----+-----------+---------------+-------------------+---------------+-------+-----------+------------+-------------+-----------+---------+----------------+\n|_corrupt_record|attendence|class_names|comments|date|for_credits|grades_revieved|level_of_difficulty|overall_quality|prof_id|rating_type|tags_by_user|textbook_used|thumbs_down|thumbs_up|would_take_again|\n+---------------+----------+-----------+--------+----+-----------+---------------+-------------------+---------------+-------+-----------+------------+-------------+-----------+---------+----------------+\n+---------------+----------+-----------+--------+----+-----------+---------------+-------------------+---------------+-------+-----------+------------+-------------+-----------+---------+----------------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://zafrin-ThinkPad-X1-Carbon-4th:4040/jobs/job?id=56","http://zafrin-ThinkPad-X1-Carbon-4th:4040/jobs/job?id=57"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\nfrom pyspark.sql.functions import col, length\n\ndf.where(length(col(\"comments\")) < 99).count()","user":"anonymous","dateUpdated":"2018-07-29T00:00:57-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1532836759613_88031298","id":"20180728-235919_1794975597","dateCreated":"2018-07-28T23:59:19-0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:7328","dateFinished":"2018-07-29T00:00:33-0400","dateStarted":"2018-07-29T00:00:32-0400","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"134651\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://zafrin-ThinkPad-X1-Carbon-4th:4040/jobs/job?id=60"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\ndf3 = df.withColumn('comment_length', length(df.comments))","user":"anonymous","dateUpdated":"2018-07-29T00:19:00-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1532837896248_803171921","id":"20180729-001816_1958379067","dateCreated":"2018-07-29T00:18:16-0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8074","dateFinished":"2018-07-29T00:19:00-0400","dateStarted":"2018-07-29T00:19:00-0400","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\ndf3.show(3)","user":"anonymous","dateUpdated":"2018-07-29T00:19:20-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1532837943643_-932271580","id":"20180729-001903_242401551","dateCreated":"2018-07-29T00:19:03-0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8146","dateFinished":"2018-07-29T00:19:20-0400","dateStarted":"2018-07-29T00:19:20-0400","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------+-----------+--------------------+----------+-----------+---------------+-------------------+---------------+-------+-----------+--------------------+-------------+-----------+---------+----------------+--------------+\n|     _corrupt_record|    attendence|class_names|            comments|      date|for_credits|grades_revieved|level_of_difficulty|overall_quality|prof_id|rating_type|        tags_by_user|textbook_used|thumbs_down|thumbs_up|would_take_again|comment_length|\n+--------------------+--------------+-----------+--------------------+----------+-----------+---------------+-------------------+---------------+-------+-----------+--------------------+-------------+-----------+---------+----------------+--------------+\n|[{\"prof_id\": 1000...|          null|       null|                null|      null|       null|           null|               null|           null|   null|       null|                null|         null|       null|     null|            null|          null|\n|                null|     Mandatory|     SOC353|This class was de...|11/15/2017|        N/A|              B|                3.0|            3.0| 100001|    average|[CLEAR GRADING CR...|          Yes|          0|        1|              No|           350|\n|                null| Not Mandatory|     SOC106|This class sucks....|10/16/2017|        Yes|            N/A|                4.0|            1.0| 100001|      awful|                  []|          Yes|          0|        0|              No|            52|\n+--------------------+--------------+-----------+--------------------+----------+-----------+---------------+-------------------+---------------+-------+-----------+--------------------+-------------+-----------+---------+----------------+--------------+\nonly showing top 3 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://zafrin-ThinkPad-X1-Carbon-4th:4040/jobs/job?id=66"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\ndf3.printSchema()","user":"anonymous","dateUpdated":"2018-07-29T00:19:47-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1532837973855_1772327404","id":"20180729-001933_529331656","dateCreated":"2018-07-29T00:19:33-0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8259","dateFinished":"2018-07-29T00:19:47-0400","dateStarted":"2018-07-29T00:19:47-0400","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- _corrupt_record: string (nullable = true)\n |-- attendence: string (nullable = true)\n |-- class_names: string (nullable = true)\n |-- comments: string (nullable = true)\n |-- date: string (nullable = true)\n |-- for_credits: string (nullable = true)\n |-- grades_revieved: string (nullable = true)\n |-- level_of_difficulty: string (nullable = true)\n |-- overall_quality: string (nullable = true)\n |-- prof_id: long (nullable = true)\n |-- rating_type: string (nullable = true)\n |-- tags_by_user: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- textbook_used: string (nullable = true)\n |-- thumbs_down: string (nullable = true)\n |-- thumbs_up: string (nullable = true)\n |-- would_take_again: string (nullable = true)\n |-- comment_length: integer (nullable = true)\n\n"}]}},{"text":"Code bellow does not work - maybe only work with numbers?","user":"anonymous","dateUpdated":"2018-07-28T23:43:29-0400","config":{"colWidth":12,"fontSize":9,"enabled":false,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1532835748678_-314301490","id":"20180728-234228_2100833444","dateCreated":"2018-07-28T23:42:28-0400","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6812"},{"text":"%pyspark\nfrom pyspark.sql.types import IntegerType\nfrom pyspark.sql.functions import udf\n\nslen = udf(lambda s: len(s), IntegerType())\n\ndf3 = df.withColumn('comment_length', slen(df.comments))","user":"anonymous","dateUpdated":"2018-07-28T23:49:06-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1532833534112_-1657754495","id":"20180728-230534_1799596750","dateCreated":"2018-07-28T23:05:34-0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5259","dateFinished":"2018-07-28T23:48:44-0400","dateStarted":"2018-07-28T23:48:44-0400","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\ndf3.select('comment_length').show(5)","user":"anonymous","dateUpdated":"2018-07-28T23:49:39-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1532836020288_436397205","id":"20180728-234700_1791603575","dateCreated":"2018-07-28T23:47:00-0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6907","dateFinished":"2018-07-28T23:49:19-0400","dateStarted":"2018-07-28T23:49:19-0400","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+\n|            comments|\n+--------------------+\n|                null|\n|This class was de...|\n|This class sucks....|\n|Dan is best. I re...|\n|Wonderful profess...|\n+--------------------+\nonly showing top 5 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://zafrin-ThinkPad-X1-Carbon-4th:4040/jobs/job?id=53"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\nfrom pyspark.sql.functions import udf","user":"anonymous","dateUpdated":"2018-07-28T23:13:56-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1532834015113_1118221241","id":"20180728-231335_1511171690","dateCreated":"2018-07-28T23:13:35-0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5580","dateFinished":"2018-07-28T23:13:56-0400","dateStarted":"2018-07-28T23:13:56-0400","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\nfrom pyspark.sql.functions import udf\n\n# Use udf to define a row-at-a-time udf\n@udf('string')\n# Input/output are both a single double value\ndef get_comment_length(comment):\n      return str(len(comment))","user":"anonymous","dateUpdated":"2018-07-29T00:11:45-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1532834032061_-909168590","id":"20180728-231352_604184546","dateCreated":"2018-07-28T23:13:52-0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5652","dateFinished":"2018-07-29T00:11:45-0400","dateStarted":"2018-07-29T00:11:45-0400","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\ndf.count()","user":"anonymous","dateUpdated":"2018-07-29T00:16:32-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1532837747908_1446422959","id":"20180729-001547_1342224518","dateCreated":"2018-07-29T00:15:47-0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:7845","dateFinished":"2018-07-29T00:16:32-0400","dateStarted":"2018-07-29T00:16:32-0400","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"183187\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://zafrin-ThinkPad-X1-Carbon-4th:4040/jobs/job?id=64"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\ndf.na.drop().count()","user":"anonymous","dateUpdated":"2018-07-29T00:17:07-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1532837798079_697556357","id":"20180729-001638_589730599","dateCreated":"2018-07-29T00:16:38-0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:7961","dateFinished":"2018-07-29T00:17:08-0400","dateStarted":"2018-07-29T00:17:07-0400","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"0\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://zafrin-ThinkPad-X1-Carbon-4th:4040/jobs/job?id=65"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\ntype(df.select())","user":"anonymous","dateUpdated":"2018-07-29T00:14:46-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1532837573321_1936904293","id":"20180729-001253_688336285","dateCreated":"2018-07-29T00:12:53-0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:7576","dateFinished":"2018-07-29T00:14:46-0400","dateStarted":"2018-07-29T00:14:46-0400","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"<class 'pyspark.sql.dataframe.DataFrame'>\n"}]}},{"text":"%pyspark\ndf3 = df.withColumn('comment_length', get_comment_length(df['comments']))","user":"anonymous","dateUpdated":"2018-07-29T00:12:00-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1532834297865_1094810566","id":"20180728-231817_1702076878","dateCreated":"2018-07-28T23:18:17-0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5765","dateFinished":"2018-07-29T00:12:00-0400","dateStarted":"2018-07-29T00:12:00-0400","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\ndf3.show(1)","user":"anonymous","dateUpdated":"2018-07-29T00:12:04-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1532834691926_-677531458","id":"20180728-232451_536980061","dateCreated":"2018-07-28T23:24:51-0400","status":"ERROR","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6112","dateFinished":"2018-07-29T00:12:05-0400","dateStarted":"2018-07-29T00:12:05-0400","results":{"code":"ERROR","msg":[{"type":"TEXT","data":"Py4JJavaError: An error occurred while calling o1177.showString.\n: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 112.0 failed 1 times, most recent failure: Lost task 0.0 in stage 112.0 (TID 3585, localhost, executor driver): org.apache.spark.api.python.PythonException: Traceback (most recent call last):\n  File \"/home/zafrin/spark-2.3.1-bin-hadoop2.7/python/lib/pyspark.zip/pyspark/worker.py\", line 230, in main\n    process()\n  File \"/home/zafrin/spark-2.3.1-bin-hadoop2.7/python/lib/pyspark.zip/pyspark/worker.py\", line 225, in process\n    serializer.dump_stream(func(split_index, iterator), outfile)\n  File \"/home/zafrin/spark-2.3.1-bin-hadoop2.7/python/lib/pyspark.zip/pyspark/serializers.py\", line 324, in dump_stream\n    self.serializer.dump_stream(self._batched(iterator), stream)\n  File \"/home/zafrin/spark-2.3.1-bin-hadoop2.7/python/lib/pyspark.zip/pyspark/serializers.py\", line 139, in dump_stream\n    for obj in iterator:\n  File \"/home/zafrin/spark-2.3.1-bin-hadoop2.7/python/lib/pyspark.zip/pyspark/serializers.py\", line 313, in _batched\n    for item in iterator:\n  File \"<string>\", line 1, in <lambda>\n  File \"/home/zafrin/spark-2.3.1-bin-hadoop2.7/python/lib/pyspark.zip/pyspark/worker.py\", line 75, in <lambda>\n    return lambda *a: f(*a)\n  File \"/home/zafrin/spark-2.3.1-bin-hadoop2.7/python/lib/pyspark.zip/pyspark/util.py\", line 55, in wrapper\n  File \"<stdin>\", line 7, in get_comment_length\nTypeError: object of type 'NoneType' has no len()\n\n\tat org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:298)\n\tat org.apache.spark.sql.execution.python.PythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:83)\n\tat org.apache.spark.sql.execution.python.PythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:66)\n\tat org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:252)\n\tat org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)\n\tat scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:439)\n\tat scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:408)\n\tat scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:408)\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage2.processNext(Unknown Source)\n\tat org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)\n\tat org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$10$$anon$1.hasNext(WholeStageCodegenExec.scala:614)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$2.apply(SparkPlan.scala:253)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$2.apply(SparkPlan.scala:247)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitionsInternal$1$$anonfun$apply$25.apply(RDD.scala:830)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitionsInternal$1$$anonfun$apply$25.apply(RDD.scala:830)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:288)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:288)\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:87)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:109)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:345)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\n\tat java.lang.Thread.run(Thread.java:748)\n\nDriver stacktrace:\n\tat org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1602)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1590)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1589)\n\tat scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)\n\tat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:1589)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:831)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:831)\n\tat scala.Option.foreach(Option.scala:257)\n\tat org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:831)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:1823)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1772)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1761)\n\tat org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:642)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2034)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2055)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2074)\n\tat org.apache.spark.sql.execution.SparkPlan.executeTake(SparkPlan.scala:363)\n\tat org.apache.spark.sql.execution.CollectLimitExec.executeCollect(limit.scala:38)\n\tat org.apache.spark.sql.Dataset.org$apache$spark$sql$Dataset$$collectFromPlan(Dataset.scala:3273)\n\tat org.apache.spark.sql.Dataset$$anonfun$head$1.apply(Dataset.scala:2484)\n\tat org.apache.spark.sql.Dataset$$anonfun$head$1.apply(Dataset.scala:2484)\n\tat org.apache.spark.sql.Dataset$$anonfun$52.apply(Dataset.scala:3254)\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:77)\n\tat org.apache.spark.sql.Dataset.withAction(Dataset.scala:3253)\n\tat org.apache.spark.sql.Dataset.head(Dataset.scala:2484)\n\tat org.apache.spark.sql.Dataset.take(Dataset.scala:2698)\n\tat org.apache.spark.sql.Dataset.showString(Dataset.scala:254)\n\tat sun.reflect.GeneratedMethodAccessor152.invoke(Unknown Source)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n\tat py4j.Gateway.invoke(Gateway.java:282)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:238)\n\tat java.lang.Thread.run(Thread.java:748)\nCaused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):\n  File \"/home/zafrin/spark-2.3.1-bin-hadoop2.7/python/lib/pyspark.zip/pyspark/worker.py\", line 230, in main\n    process()\n  File \"/home/zafrin/spark-2.3.1-bin-hadoop2.7/python/lib/pyspark.zip/pyspark/worker.py\", line 225, in process\n    serializer.dump_stream(func(split_index, iterator), outfile)\n  File \"/home/zafrin/spark-2.3.1-bin-hadoop2.7/python/lib/pyspark.zip/pyspark/serializers.py\", line 324, in dump_stream\n    self.serializer.dump_stream(self._batched(iterator), stream)\n  File \"/home/zafrin/spark-2.3.1-bin-hadoop2.7/python/lib/pyspark.zip/pyspark/serializers.py\", line 139, in dump_stream\n    for obj in iterator:\n  File \"/home/zafrin/spark-2.3.1-bin-hadoop2.7/python/lib/pyspark.zip/pyspark/serializers.py\", line 313, in _batched\n    for item in iterator:\n  File \"<string>\", line 1, in <lambda>\n  File \"/home/zafrin/spark-2.3.1-bin-hadoop2.7/python/lib/pyspark.zip/pyspark/worker.py\", line 75, in <lambda>\n    return lambda *a: f(*a)\n  File \"/home/zafrin/spark-2.3.1-bin-hadoop2.7/python/lib/pyspark.zip/pyspark/util.py\", line 55, in wrapper\n  File \"<stdin>\", line 7, in get_comment_length\nTypeError: object of type 'NoneType' has no len()\n\n\tat org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:298)\n\tat org.apache.spark.sql.execution.python.PythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:83)\n\tat org.apache.spark.sql.execution.python.PythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:66)\n\tat org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:252)\n\tat org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)\n\tat scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:439)\n\tat scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:408)\n\tat scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:408)\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage2.processNext(Unknown Source)\n\tat org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)\n\tat org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$10$$anon$1.hasNext(WholeStageCodegenExec.scala:614)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$2.apply(SparkPlan.scala:253)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$2.apply(SparkPlan.scala:247)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitionsInternal$1$$anonfun$apply$25.apply(RDD.scala:830)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitionsInternal$1$$anonfun$apply$25.apply(RDD.scala:830)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:288)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:288)\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:87)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:109)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:345)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\n\t... 1 more\n\n(<class 'py4j.protocol.Py4JJavaError'>, Py4JJavaError('An error occurred while calling o1177.showString.\\n', JavaObject id=o1179), <traceback object at 0x7fe8f2f102c8>)"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://zafrin-ThinkPad-X1-Carbon-4th:4040/jobs/job?id=61"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\ncount = 0\nfor i in df.select('comments').collect():\n    print(i)\n    print(type(i))\n    print(len(i), '\\n')\n    count +=1\n    if count >5: break","user":"anonymous","dateUpdated":"2018-07-28T23:36:05-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1532834724219_1650257105","id":"20180728-232524_1354246502","dateCreated":"2018-07-28T23:25:24-0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6194","dateFinished":"2018-07-28T23:36:06-0400","dateStarted":"2018-07-28T23:36:05-0400","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Row(comments=None)\n<class 'pyspark.sql.types.Row'>\n1 \n\nRow(comments=\"This class was definitely not what I thought it would be. Heavily reading based. If you read the articles you'll be fine and he gives you opportunities to miss some of the reaction papers he assigns. The book essay is a big part of your grade: START IT EARLY! Overall he's an okay teacher but kind of boring and the class is not based on medications.\")\n<class 'pyspark.sql.types.Row'>\n1 \n\nRow(comments=\"This class sucks. don't take it. you will regret it.\")\n<class 'pyspark.sql.types.Row'>\n1 \n\nRow(comments='Dan is best. I really recommend this class if you are interested in the health field or just want an awesome class.')\n<class 'pyspark.sql.types.Row'>\n1 \n\nRow(comments=\"Wonderful professor, inspired great interest in the subject. One of the best professors I've had.\")\n<class 'pyspark.sql.types.Row'>\n1 \n\nRow(comments='Class was ok. Had an option to complete a certain # out of total assignments. Was always pushing deadlines back. He did tell me it was ok to take on a topic that has yet to be researched, went thru ideas for the paper, told me i needed to find research on it on graded last edit? that was a bit annoying. Nice guy. not very interesting. dont avoid')\n<class 'pyspark.sql.types.Row'>\n1 \n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://zafrin-ThinkPad-X1-Carbon-4th:4040/jobs/job?id=50"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2018-07-28T23:31:39-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1532835099376_1827419205","id":"20180728-233139_1015502094","dateCreated":"2018-07-28T23:31:39-0400","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6561"}],"name":"EDA with Spark Dataframe","id":"2DK5C8GFF","noteParams":{},"noteForms":{},"angularObjects":{"python:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}